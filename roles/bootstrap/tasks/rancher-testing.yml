---
- name: PIP | install docker lib
  pip:
    name: docker
    virtualenv_command: pyvenv
    virtualenv: "{{ ansible_env.HOME }}/PyEnv"

- name: change python interpreter
  set_fact:
    ansible_python_interpreter: "{{ ansible_env.HOME }}/PyEnv/bin/python"

- name: DOCKER | start the rancher server
  docker_container:
    name: rancher-server
    image: rancher/server
    restart: true
    restart_policy: unless-stopped
    published_ports: 8080:8080
    detach: true

- name: ensure rancher server is running
  wait_for:
    port: 8080
    delay: 5
